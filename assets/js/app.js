document.addEventListener("DOMContentLoaded",()=>{const body=document.body,viewport=document.getElementById("viewport"),emailSpan=document.querySelector(".obfuscated-email"),footerEmail=document.querySelector(".footer-email"),copyBtn=document.querySelector(".copy-email"),copyStatus=document.querySelector(".copy-email-status"),printBtn=document.getElementById("printCv"),printBtnFooter=document.getElementById("printCvFooter"),effectToggle=document.getElementById("effectToggle");const buildEmail=(el)=>{if(!el)return null;const user=el.dataset.user,domain=el.dataset.domain;if(!user||!domain)return null;return `${user}@${domain}`};const email=buildEmail(emailSpan);if(email&&emailSpan){emailSpan.setAttribute("data-email",email);emailSpan.setAttribute("aria-label",`Email ${email}`)}if(email&&footerEmail){footerEmail.addEventListener("click",(evt)=>{evt.preventDefault();window.location.href=`mailto:${email}`})}if(copyBtn&&email){const defaultLabel=copyBtn.textContent;copyBtn.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(email);copyBtn.textContent="Copied!";copyBtn.classList.add("copied");copyStatus&&(copyStatus.textContent="Email copied to clipboard.");setTimeout(()=>{copyBtn.textContent=defaultLabel;copyBtn.classList.remove("copied");copyStatus&&(copyStatus.textContent="")},1800)}catch(err){console.warn("Clipboard copy unavailable",err);window.prompt("Copy email to clipboard:",email)}})}const triggerPrint=()=>window.print();printBtn&&printBtn.addEventListener("click",triggerPrint);printBtnFooter&&printBtnFooter.addEventListener("click",triggerPrint);const disableEffects=()=>{body.classList.add("effects-off");viewport&&viewport.classList.add("effects-off");effectToggle&&(effectToggle.setAttribute("aria-pressed","true"),effectToggle.textContent="Enable CRT effects")};const enableEffects=()=>{body.classList.remove("effects-off");viewport&&viewport.classList.remove("effects-off");effectToggle&&(effectToggle.setAttribute("aria-pressed","false"),effectToggle.textContent="Reduce CRT effects")};const prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)");if(prefersReducedMotion.matches){disableEffects()}effectToggle&&effectToggle.addEventListener("click",()=>{const isPressed=effectToggle.getAttribute("aria-pressed")==="true";isPressed?enableEffects():disableEffects()});prefersReducedMotion.addEventListener&&prefersReducedMotion.addEventListener("change",(evt)=>{evt.matches?disableEffects():enableEffects()});const footerLink=document.querySelector(".footer-print");if(footerLink){footerLink.addEventListener("click",triggerPrint)}});
